<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">

<select resultType="board.dto.BoardDTO" id="list">
select num,writer,subject,reg_date,readcount,filename,filesize,down,ip
from board
order by num desc </select>

<insert id="insert">
insert into board(num,writer,subject,passwd,ref,re_step,re_level,content,ip,filename,filesize)
values( (select nvl(max(num)+1,1)
 from board),#{writer},#{subject},#{passwd},(select nvl(max(num)+1,1) from board),1,0,#{content},#{ip},#{filename},#{filesize}) </insert>

<select resultType="String" id="getFileName">
select filename
from board
where num=#{num} </select>

<update id="plusDown">
update board set down+1 where num =#{num}
</update>
<!-- 게시물 상세 정보 -->
<select id="view" resultType="board.dto.BoardDTO">
select * from board
where num=#{num}
</select>

<!-- 조회수 증가 처리 -->
<update id="plusReadCount">
update board set readcount= readcount+1 
where num=#{num}
</update>

</mapper>